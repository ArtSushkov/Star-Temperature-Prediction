# Прогнозирование температуры звезды с помощью нейронных сетей

[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

## Описание проекта

Проект разработан для обсерватории «Небо на ладони» с целью создания нейронной сети, предсказывающей абсолютную температуру на поверхности звезд. Традиционные методы расчета температуры (закон смещения Вина, закон Стефана-Больцмана, спектральный анализ) имеют ограничения, поэтому внедрение машинного обучения позволяет получить более точные и удобные прогнозы.

**Ключевая цель:** Разработать нейронную сеть с метрикой RMSE ≤ 4500 для предсказания температуры звезд.

### Структура проекта

```
Star-Temperature-Prediction/
│
├── notebooks/
│   ├── star_temperature_prediction.ipynb  # Основная тетрадка проекта
│   └── utils.py                          # Вспомогательные функции
│
├── .gitignore
├── LICENSE
├── requirements.txt
└── README.md
```

## Стек технологий

**Глубокое обучение:**
- `PyTorch` - фреймворк для построения и обучения нейронных сетей
- `torch.nn` - модули нейронных сетей
- `torch.optim` - алгоритмы оптимизации

**Анализ данных и визуализация:**
- `pandas`, `numpy` - обработка и анализ данных
- `matplotlib`, `seaborn` - статическая визуализация
- `plotly` - интерактивная визуализация

**Статистический анализ:**
- `scipy` - научные вычисления
- `statsmodels` - статистическое моделирование
- `phik` - анализ корреляций для смешанных типов данных

**Предобработка данных:**
- `scikit-learn` - масштабирование и кодирование признаков

**Вспомогательные инструменты:**
- `tqdm` - прогресс-бары
- `IPython` - интерактивная работа в Jupyter

## Основные этапы проекта

### 1. Предобработка данных
- Проверка на пропуски и дубликаты
- Приведение категориальных признаков к единому формату
- Корректировка типов данных
- Балансировка датасета (увеличение редких категорий)

### 2. Исследовательский анализ данных
- Статистическое описание числовых и категориальных признаков
- Визуализация распределений и взаимосвязей
- Анализ корреляций между признаками и целевой переменной
- Выявление значимых паттернов и закономерностей

### 3. Подготовка данных для моделирования
- Масштабирование числовых признаков
- Кодирование категориальных переменных
- Стратифицированное разделение на обучающую и тестовую выборки
- Создание тензоров для PyTorch

### 4. Построение и обучение моделей
**Baseline-модель:**
- Простая полносвязная нейронная сеть
- Подбор архитектуры (количество слоев, нейронов, функции активации)
- Оценка качества предсказаний

**Улучшенная модель:**
- Глубокая архитектура с Batch Normalization
- Поиск оптимальных гиперпараметров (batch_size, learning_rate)
- Регуляризация для предотвращения переобучения

### 5. Сравнительный анализ
- Оценка метрик качества (RMSE)
- Анализ времени обучения
- Визуализация предсказаний ("Факт — Прогноз")
- Интерпретация результатов

## Ключевые выводы

1. **Качество моделей:** Улучшенная модель с Batch Normalization показала RMSE = 3474, что значительно лучше требуемого порога в 4500.

2. **Важность признаков:** Наибольшая корреляция температуры наблюдается с цветом звезды (Phi-K = 0.91), а не с ее типом.

3. **Архитектура сети:** Глубокая архитектура [64, 32, 32, 16] с Batch Normalization демонстрирует наилучшие результаты.

4. **Гиперпараметры:** Оптимальные параметры обучения: batch_size = 16, learning_rate = 2e-3.

5. **Точность прогнозов:** Модель точнее предсказывает температуры ниже 5000K.

## Приобретенные навыки

- **Построение нейронных сетей** - проектирование архитектур с использованием PyTorch
- **Управление обучением** - работа с гиперпараметрами и оптимизаторами
- **Регуляризация** - применение Batch Normalization для улучшения сходимости
- **Анализ данных** - комплексное исследование астрофизических данных
- **Визуализация** - создание информативных графиков и диаграмм
- **Валидация моделей** - оценка качества и интерпретация результатов

## Особенности реализации

Модуль `utils.py` содержит кастомные функции для анализа данных:

- **`extended_describe()`** - расширенное статистическое описание данных
- **`plot_distribution_with_boxplot()`** - визуализация распределений с разделением по категориям
- **`create_sunburst_plot()`** - интерактивная sunburst-диаграмма для категориальных данных
- **`phik_correlation_matrix()`** - анализ корреляций с помощью Phi-K коэффициента
- **`vif()`** - анализ мультиколлинеарности через VIF

**Пример использования в ноутбуке:**
```python
from utils import *

# Расширенное описание данных
extended_describe(df, name="Звезды")

# Визуализация распределений
plot_distribution_with_boxplot(
    df, 
    features=[('Relative luminosity', 'Относительная светимость'), 
              ('Relative radius', 'Относительный радиус')],
    target_col='Star color'
)

# Анализ корреляций
correlated_pairs, interval_cols, target_corrs = phik_correlation_matrix(
    df, target_col='Temperature', threshold=0.7
)
```

Все функции сопровождаются подробной документацией и примерами использования.
